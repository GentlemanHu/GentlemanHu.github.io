{"title":"Google在线深度学习神器colab把玩","slug":"Google在线深度学习神器colab把玩","date":"2020-08-10T01:36:24.000Z","updated":"2023-11-06T14:15:17.979Z","comments":true,"path":"api/articles/Google在线深度学习神器colab把玩.json","excerpt":null,"covers":["https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101129196.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101210851.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101415115.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101513478.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810102213746.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103313123.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103458678.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103619187.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103851755.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810102213746.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104336106.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104745488.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104901196.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810105129368.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810100453017.png","https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810105410318.png"],"content":"<h2 id=\"Colaboratory入门玩\"><a href=\"#Colaboratory入门玩\" class=\"headerlink\" title=\"Colaboratory入门玩\"></a>Colaboratory入门玩</h2><div class=\"note success\">\n            <p><a href=\"https://colab.research.google.com/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n          </div>\n\n<div class=\"note default\">\n            <p><span style=\"color:green\">打开官网，跟着指引来一遍</span></p>\n          </div>\n<ul>\n<li>基于Jupyter Notebook，托管于Google，使用起来大同小异，熟悉Jupyter的话，也是很方便的。</li>\n<li>代码和注释并存</li>\n<li><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101129196.png\" alt=\"image-20200810101129196\"></li>\n<li>直接可视化显示</li>\n<li><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101210851.png\" alt=\"image-20200810101210851\"></li>\n<li>其他很多特性，比如还能再cell处评论，很方便</li>\n<li>可以本地导入项目，也能Google Drive对接存储。</li>\n</ul>\n<p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101415115.png\" alt=\"image-20200810101415115\"></p>\n<div class=\"note default\">\n            <p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101513478.png\" alt=\"image-20200810101513478\"></p><span style=\"color:green\"><p>配置不错，对于深度学习机器学习提供了很大帮助。</p><p>其他更多在<a href=\"https://colab.research.google.com/notebooks/intro.ipynb\" target=\"_blank\" rel=\"noopener\">官方教程</a><br></span></p>\n          </div>\n\n<h2 id=\"ssh连接\"><a href=\"#ssh连接\" class=\"headerlink\" title=\"ssh连接\"></a>ssh连接</h2><blockquote>\n<p>尽管来说，Jupyter很方便，但是对于某些不可描述操作，还是终端内好用。所以就想办法通过ssh连接到它后端。利用到了ngrok来内网穿透。</p>\n<p>脚本找了两个版本，用其中任意一个都可以。</p>\n</blockquote>\n<p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810102213746.png\" alt=\"image-20200810102213746\"></p>\n<h3 id=\"前置准备\"><a href=\"#前置准备\" class=\"headerlink\" title=\"前置准备\"></a>前置准备</h3><p> Sign up for <a href=\"https://ngrok.com/\" target=\"_blank\" rel=\"noopener\">ngrok</a></p>\n<blockquote>\n<ul>\n<li><p>You don’t need to buy paid plans. If you don’t want to sign up for anything, there is <a href=\"https://serveo.net/\" target=\"_blank\" rel=\"noopener\">Serveo</a> version in following link. But it is slower than <a href=\"https://ngrok.com/\" target=\"_blank\" rel=\"noopener\">ngrok</a> version.</p>\n<p><a href=\"https://github.com/demotomohiro/Google-Colaboratory-SSH-samples/blob/master/src/ssh_serveo.ipynb\" target=\"_blank\" rel=\"noopener\">https://github.com/demotomohiro/Google-Colaboratory-SSH-samples/blob/master/src/ssh_serveo.ipynb</a></p>\n<p>注册ngrok，转到token页面，为后边准备。</p>\n<p><a href=\"https://dashboard.ngrok.com/auth/your-authtoken\" target=\"_blank\" rel=\"noopener\">Get Your Auth Ngrok Token</a></p>\n</li>\n</ul>\n</blockquote>\n<h3 id=\"Version-1\"><a href=\"#Version-1\" class=\"headerlink\" title=\"Version 1\"></a>Version 1</h3><ol>\n<li><p>复制代码到Colab任意创建一个新cell中</p>\n<ul>\n<li><p>ssh only</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!pip install git+https://github.com/demotomohiro/remocolab.git</span><br><span class=\"line\">import remocolab</span><br><span class=\"line\">remocolab.setupSSHD()</span><br></pre></td></tr></table></figure></li>\n<li><p>ssh and vnc</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!pip install git+https://github.com/demotomohiro/remocolab.git</span><br><span class=\"line\">   import remocolab</span><br><span class=\"line\">   remocolab.setupVNC()</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>点左侧运行</p>\n<ul>\n<li><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103313123.png\" alt=\"image-20200810103313123\"></li>\n</ul>\n</li>\n<li><p>把上边复制的authtoken粘到输入框</p>\n<ul>\n<li>等待上边代码部署到输入框时候，粘贴token，回车</li>\n<li><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103458678.png\" alt=\"image-20200810103458678\"></li>\n<li>然后选区域，选最近差不多，我选新加坡<img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103619187.png\" alt=\"image-20200810103619187\"></li>\n</ul>\n</li>\n<li><p>愉快登录ssh</p>\n<ul>\n<li>等待部署完成后，会显示用户名和密码，以及ssh登录命令，有手就行。</li>\n<li><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103851755.png\" alt=\"image-20200810103851755\"></li>\n<li><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810102213746.png\" alt=\"image-20200810102213746\"></li>\n</ul>\n</li>\n</ol>\n<h3 id=\"Version-2\"><a href=\"#Version-2\" class=\"headerlink\" title=\"Version 2\"></a>Version 2</h3><p>步骤类似，粘贴脚本就行了</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Install useful stuff</span></span><br><span class=\"line\">! apt install --yes ssh screen nano htop ranger git &gt; /dev/null</span><br><span class=\"line\"><span class=\"comment\"># SSH setting</span></span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"root:carbonara\"</span> | chpasswd</span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"PasswordAuthentication yes\"</span> &gt; /etc/ssh/sshd_config</span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"PermitUserEnvironment yes\"</span> &gt;&gt; /etc/ssh/sshd_config</span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"PermitRootLogin yes\"</span> &gt;&gt; /etc/ssh/sshd_config</span><br><span class=\"line\">! service ssh restart &gt; /dev/null</span><br><span class=\"line\"><span class=\"comment\"># Download ngrok</span></span><br><span class=\"line\">! wget -q -c -nc https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip</span><br><span class=\"line\">! unzip -qq -n ngrok-stable-linux-amd64.zip</span><br><span class=\"line\"><span class=\"comment\"># Run ngrok</span></span><br><span class=\"line\">authtoken = <span class=\"string\">\"PUT_YOUR_TOKEN_HERE\"</span></span><br><span class=\"line\">get_ipython().system_raw(<span class=\"string\">'./ngrok authtoken $authtoken &amp;&amp; ./ngrok tcp 22 &amp;'</span>)</span><br><span class=\"line\">! sleep 3</span><br><span class=\"line\"><span class=\"comment\"># Get the address for SSH</span></span><br><span class=\"line\">import requests</span><br><span class=\"line\">from re import sub</span><br><span class=\"line\">r = requests.get(<span class=\"string\">'http://localhost:4040/api/tunnels'</span>)</span><br><span class=\"line\">str_ssh = r.json()[<span class=\"string\">'tunnels'</span>][0][<span class=\"string\">'public_url'</span>]</span><br><span class=\"line\">str_ssh = sub(<span class=\"string\">\"tcp://\"</span>, <span class=\"string\">\"\"</span>, str_ssh)</span><br><span class=\"line\">str_ssh = sub(<span class=\"string\">\":\"</span>, <span class=\"string\">\" -p \"</span>, str_ssh)</span><br><span class=\"line\">str_ssh = <span class=\"string\">\"ssh root@\"</span> + str_ssh</span><br><span class=\"line\"><span class=\"built_in\">print</span>(str_ssh)</span><br></pre></td></tr></table></figure>\n\n<div class=\"note success\">\n            <span style=\"color:green\">只需要把上边`authtoken`换成自己的，运行！</span>\n          </div>\n\n<ul>\n<li>等待部署完成，ssh登录命令</li>\n</ul>\n<p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104336106.png\" alt=\"image-20200810104336106\"></p>\n<blockquote>\n<p>默认密码为<code>carbonara</code></p>\n<p>及时更改密码</p>\n</blockquote>\n<h2 id=\"配置vscode\"><a href=\"#配置vscode\" class=\"headerlink\" title=\"配置vscode\"></a>配置vscode</h2><blockquote>\n<p>既然ssh连接了，各种服务也都能搭建了，这里搭建个vscode方便敲代码</p>\n</blockquote>\n<ol>\n<li>挂载Google Drive</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Mount Google Drive and make some folders for vscode</span></span><br><span class=\"line\">from google.colab import drive</span><br><span class=\"line\">drive.mount(<span class=\"string\">'/googledrive'</span>)</span><br><span class=\"line\">! mkdir -p /googledrive/My\\ Drive/colabdrive</span><br><span class=\"line\">! mkdir -p /googledrive/My\\ Drive/colabdrive/root/.<span class=\"built_in\">local</span>/share/code-server</span><br><span class=\"line\">! ln -s /googledrive/My\\ Drive/colabdrive /</span><br><span class=\"line\">! ln -s /googledrive/My\\ Drive/colabdrive/root/.<span class=\"built_in\">local</span>/share/code-server /root/.<span class=\"built_in\">local</span>/share/</span><br></pre></td></tr></table></figure>\n\n<p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104745488.png\" alt=\"image-20200810104745488\"></p>\n<p>点击链接验证授权</p>\n<ol start=\"2\">\n<li>下载部署<code>code-server</code></li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">! curl -fsSL https://code-server.dev/install.sh | sh &gt; /dev/null</span><br><span class=\"line\">! code-server --<span class=\"built_in\">bind</span>-addr 127.0.0.1:9999 --auth none &amp;</span><br></pre></td></tr></table></figure>\n\n<p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104901196.png\" alt=\"image-20200810104901196\"></p>\n<ol start=\"3\">\n<li>本地shell运行命令映射</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -L 9999:localhost:9999 root@0.tcp.ngrok.io -p 14407</span><br></pre></td></tr></table></figure>\n\n<p>其中9999端口为上边指定code-server端口，可以更换，但必须一致。</p>\n<p>后边14407端口为ssh端口</p>\n<ol start=\"4\">\n<li>愉快敲代码</li>\n</ol>\n<ul>\n<li>打开<code>http://127.0.0.1:9999</code></li>\n<li><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810105129368.png\" alt=\"image-20200810105129368\"></li>\n</ul>\n<h2 id=\"其他玩法\"><a href=\"#其他玩法\" class=\"headerlink\" title=\"其他玩法\"></a>其他玩法</h2><ul>\n<li>Aria2 离线下载</li>\n<li>Youtube-dl 转存</li>\n<li>Rclone</li>\n<li>gd-utils</li>\n<li>etc…</li>\n</ul>\n<blockquote>\n<p>更多自己探索发现</p>\n</blockquote>\n<h2 id=\"Related\"><a href=\"#Related\" class=\"headerlink\" title=\"Related\"></a>Related</h2><ul>\n<li><a href=\"https://internet-of-tomohiro.netlify.app/google_colab/ssh.en.html\" target=\"_blank\" rel=\"noopener\">How to access Google Colaboratory using ssh</a></li>\n<li><a href=\"https://towardsdatascience.com/colab-free-gpu-ssh-visual-studio-code-server-36fe1d3c5243\" target=\"_blank\" rel=\"noopener\">Colab on steroids: free GPU instances with SSH access and Visual Studio Code Server</a></li>\n<li><a href=\"https://colab.research.google.com/notebooks/intro.ipynb\" target=\"_blank\" rel=\"noopener\">Colab Intro</a></li>\n<li><a href=\"https://dashboard.ngrok.com/auth/your-authtoken\" target=\"_blank\" rel=\"noopener\">Get Your Auth Ngrok Token</a></li>\n<li><a href=\"https://www.google.com/\" target=\"_blank\" rel=\"noopener\">Google</a></li>\n</ul>\n<p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810100453017.png\" alt=\"image-20200810100453017\"></p>\n<hr>\n<hr>\n<blockquote>\n<p>Colab方便，但不要滥用。</p>\n<p>免费版本一般12h，但更多取决于GPU使用度</p>\n<p>学习，学习，学习！</p>\n<p><img src= \"/img/loading.gif\" data-src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810105410318.png\" alt=\"image-20200810105410318\"></p>\n</blockquote>\n","more":"<h2 id=\"Colaboratory入门玩\"><a href=\"#Colaboratory入门玩\" class=\"headerlink\" title=\"Colaboratory入门玩\"></a>Colaboratory入门玩</h2><div class=\"note success\">\n            <p><a href=\"https://colab.research.google.com/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n          </div>\n\n<div class=\"note default\">\n            <p><span style=\"color:green\">打开官网，跟着指引来一遍</span></p>\n          </div>\n<ul>\n<li>基于Jupyter Notebook，托管于Google，使用起来大同小异，熟悉Jupyter的话，也是很方便的。</li>\n<li>代码和注释并存</li>\n<li><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101129196.png\" alt=\"image-20200810101129196\"></li>\n<li>直接可视化显示</li>\n<li><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101210851.png\" alt=\"image-20200810101210851\"></li>\n<li>其他很多特性，比如还能再cell处评论，很方便</li>\n<li>可以本地导入项目，也能Google Drive对接存储。</li>\n</ul>\n<p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101415115.png\" alt=\"image-20200810101415115\"></p>\n<div class=\"note default\">\n            <p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810101513478.png\" alt=\"image-20200810101513478\"></p><span style=\"color:green\"><p>配置不错，对于深度学习机器学习提供了很大帮助。</p><p>其他更多在<a href=\"https://colab.research.google.com/notebooks/intro.ipynb\" target=\"_blank\" rel=\"noopener\">官方教程</a><br></span></p>\n          </div>\n\n<h2 id=\"ssh连接\"><a href=\"#ssh连接\" class=\"headerlink\" title=\"ssh连接\"></a>ssh连接</h2><blockquote>\n<p>尽管来说，Jupyter很方便，但是对于某些不可描述操作，还是终端内好用。所以就想办法通过ssh连接到它后端。利用到了ngrok来内网穿透。</p>\n<p>脚本找了两个版本，用其中任意一个都可以。</p>\n</blockquote>\n<p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810102213746.png\" alt=\"image-20200810102213746\"></p>\n<h3 id=\"前置准备\"><a href=\"#前置准备\" class=\"headerlink\" title=\"前置准备\"></a>前置准备</h3><p> Sign up for <a href=\"https://ngrok.com/\" target=\"_blank\" rel=\"noopener\">ngrok</a></p>\n<blockquote>\n<ul>\n<li><p>You don’t need to buy paid plans. If you don’t want to sign up for anything, there is <a href=\"https://serveo.net/\" target=\"_blank\" rel=\"noopener\">Serveo</a> version in following link. But it is slower than <a href=\"https://ngrok.com/\" target=\"_blank\" rel=\"noopener\">ngrok</a> version.</p>\n<p><a href=\"https://github.com/demotomohiro/Google-Colaboratory-SSH-samples/blob/master/src/ssh_serveo.ipynb\" target=\"_blank\" rel=\"noopener\">https://github.com/demotomohiro/Google-Colaboratory-SSH-samples/blob/master/src/ssh_serveo.ipynb</a></p>\n<p>注册ngrok，转到token页面，为后边准备。</p>\n<p><a href=\"https://dashboard.ngrok.com/auth/your-authtoken\" target=\"_blank\" rel=\"noopener\">Get Your Auth Ngrok Token</a></p>\n</li>\n</ul>\n</blockquote>\n<h3 id=\"Version-1\"><a href=\"#Version-1\" class=\"headerlink\" title=\"Version 1\"></a>Version 1</h3><ol>\n<li><p>复制代码到Colab任意创建一个新cell中</p>\n<ul>\n<li><p>ssh only</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!pip install git+https://github.com/demotomohiro/remocolab.git</span><br><span class=\"line\">import remocolab</span><br><span class=\"line\">remocolab.setupSSHD()</span><br></pre></td></tr></table></figure></li>\n<li><p>ssh and vnc</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!pip install git+https://github.com/demotomohiro/remocolab.git</span><br><span class=\"line\">   import remocolab</span><br><span class=\"line\">   remocolab.setupVNC()</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>点左侧运行</p>\n<ul>\n<li><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103313123.png\" alt=\"image-20200810103313123\"></li>\n</ul>\n</li>\n<li><p>把上边复制的authtoken粘到输入框</p>\n<ul>\n<li>等待上边代码部署到输入框时候，粘贴token，回车</li>\n<li><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103458678.png\" alt=\"image-20200810103458678\"></li>\n<li>然后选区域，选最近差不多，我选新加坡<img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103619187.png\" alt=\"image-20200810103619187\"></li>\n</ul>\n</li>\n<li><p>愉快登录ssh</p>\n<ul>\n<li>等待部署完成后，会显示用户名和密码，以及ssh登录命令，有手就行。</li>\n<li><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810103851755.png\" alt=\"image-20200810103851755\"></li>\n<li><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810102213746.png\" alt=\"image-20200810102213746\"></li>\n</ul>\n</li>\n</ol>\n<h3 id=\"Version-2\"><a href=\"#Version-2\" class=\"headerlink\" title=\"Version 2\"></a>Version 2</h3><p>步骤类似，粘贴脚本就行了</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Install useful stuff</span></span><br><span class=\"line\">! apt install --yes ssh screen nano htop ranger git &gt; /dev/null</span><br><span class=\"line\"><span class=\"comment\"># SSH setting</span></span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"root:carbonara\"</span> | chpasswd</span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"PasswordAuthentication yes\"</span> &gt; /etc/ssh/sshd_config</span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"PermitUserEnvironment yes\"</span> &gt;&gt; /etc/ssh/sshd_config</span><br><span class=\"line\">! <span class=\"built_in\">echo</span> <span class=\"string\">\"PermitRootLogin yes\"</span> &gt;&gt; /etc/ssh/sshd_config</span><br><span class=\"line\">! service ssh restart &gt; /dev/null</span><br><span class=\"line\"><span class=\"comment\"># Download ngrok</span></span><br><span class=\"line\">! wget -q -c -nc https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip</span><br><span class=\"line\">! unzip -qq -n ngrok-stable-linux-amd64.zip</span><br><span class=\"line\"><span class=\"comment\"># Run ngrok</span></span><br><span class=\"line\">authtoken = <span class=\"string\">\"PUT_YOUR_TOKEN_HERE\"</span></span><br><span class=\"line\">get_ipython().system_raw(<span class=\"string\">'./ngrok authtoken $authtoken &amp;&amp; ./ngrok tcp 22 &amp;'</span>)</span><br><span class=\"line\">! sleep 3</span><br><span class=\"line\"><span class=\"comment\"># Get the address for SSH</span></span><br><span class=\"line\">import requests</span><br><span class=\"line\">from re import sub</span><br><span class=\"line\">r = requests.get(<span class=\"string\">'http://localhost:4040/api/tunnels'</span>)</span><br><span class=\"line\">str_ssh = r.json()[<span class=\"string\">'tunnels'</span>][0][<span class=\"string\">'public_url'</span>]</span><br><span class=\"line\">str_ssh = sub(<span class=\"string\">\"tcp://\"</span>, <span class=\"string\">\"\"</span>, str_ssh)</span><br><span class=\"line\">str_ssh = sub(<span class=\"string\">\":\"</span>, <span class=\"string\">\" -p \"</span>, str_ssh)</span><br><span class=\"line\">str_ssh = <span class=\"string\">\"ssh root@\"</span> + str_ssh</span><br><span class=\"line\"><span class=\"built_in\">print</span>(str_ssh)</span><br></pre></td></tr></table></figure>\n\n<div class=\"note success\">\n            <span style=\"color:green\">只需要把上边`authtoken`换成自己的，运行！</span>\n          </div>\n\n<ul>\n<li>等待部署完成，ssh登录命令</li>\n</ul>\n<p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104336106.png\" alt=\"image-20200810104336106\"></p>\n<blockquote>\n<p>默认密码为<code>carbonara</code></p>\n<p>及时更改密码</p>\n</blockquote>\n<h2 id=\"配置vscode\"><a href=\"#配置vscode\" class=\"headerlink\" title=\"配置vscode\"></a>配置vscode</h2><blockquote>\n<p>既然ssh连接了，各种服务也都能搭建了，这里搭建个vscode方便敲代码</p>\n</blockquote>\n<ol>\n<li>挂载Google Drive</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Mount Google Drive and make some folders for vscode</span></span><br><span class=\"line\">from google.colab import drive</span><br><span class=\"line\">drive.mount(<span class=\"string\">'/googledrive'</span>)</span><br><span class=\"line\">! mkdir -p /googledrive/My\\ Drive/colabdrive</span><br><span class=\"line\">! mkdir -p /googledrive/My\\ Drive/colabdrive/root/.<span class=\"built_in\">local</span>/share/code-server</span><br><span class=\"line\">! ln -s /googledrive/My\\ Drive/colabdrive /</span><br><span class=\"line\">! ln -s /googledrive/My\\ Drive/colabdrive/root/.<span class=\"built_in\">local</span>/share/code-server /root/.<span class=\"built_in\">local</span>/share/</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104745488.png\" alt=\"image-20200810104745488\"></p>\n<p>点击链接验证授权</p>\n<ol start=\"2\">\n<li>下载部署<code>code-server</code></li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">! curl -fsSL https://code-server.dev/install.sh | sh &gt; /dev/null</span><br><span class=\"line\">! code-server --<span class=\"built_in\">bind</span>-addr 127.0.0.1:9999 --auth none &amp;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810104901196.png\" alt=\"image-20200810104901196\"></p>\n<ol start=\"3\">\n<li>本地shell运行命令映射</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -L 9999:localhost:9999 root@0.tcp.ngrok.io -p 14407</span><br></pre></td></tr></table></figure>\n\n<p>其中9999端口为上边指定code-server端口，可以更换，但必须一致。</p>\n<p>后边14407端口为ssh端口</p>\n<ol start=\"4\">\n<li>愉快敲代码</li>\n</ol>\n<ul>\n<li>打开<code>http://127.0.0.1:9999</code></li>\n<li><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810105129368.png\" alt=\"image-20200810105129368\"></li>\n</ul>\n<h2 id=\"其他玩法\"><a href=\"#其他玩法\" class=\"headerlink\" title=\"其他玩法\"></a>其他玩法</h2><ul>\n<li>Aria2 离线下载</li>\n<li>Youtube-dl 转存</li>\n<li>Rclone</li>\n<li>gd-utils</li>\n<li>etc…</li>\n</ul>\n<blockquote>\n<p>更多自己探索发现</p>\n</blockquote>\n<h2 id=\"Related\"><a href=\"#Related\" class=\"headerlink\" title=\"Related\"></a>Related</h2><ul>\n<li><a href=\"https://internet-of-tomohiro.netlify.app/google_colab/ssh.en.html\" target=\"_blank\" rel=\"noopener\">How to access Google Colaboratory using ssh</a></li>\n<li><a href=\"https://towardsdatascience.com/colab-free-gpu-ssh-visual-studio-code-server-36fe1d3c5243\" target=\"_blank\" rel=\"noopener\">Colab on steroids: free GPU instances with SSH access and Visual Studio Code Server</a></li>\n<li><a href=\"https://colab.research.google.com/notebooks/intro.ipynb\" target=\"_blank\" rel=\"noopener\">Colab Intro</a></li>\n<li><a href=\"https://dashboard.ngrok.com/auth/your-authtoken\" target=\"_blank\" rel=\"noopener\">Get Your Auth Ngrok Token</a></li>\n<li><a href=\"https://www.google.com/\" target=\"_blank\" rel=\"noopener\">Google</a></li>\n</ul>\n<p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810100453017.png\" alt=\"image-20200810100453017\"></p>\n<hr>\n<hr>\n<blockquote>\n<p>Colab方便，但不要滥用。</p>\n<p>免费版本一般12h，但更多取决于GPU使用度</p>\n<p>学习，学习，学习！</p>\n<p><img src=\"https://gitee.com/gentlemanhu/public-store/raw/master//images/image-20200810105410318.png\" alt=\"image-20200810105410318\"></p>\n</blockquote>\n","categories":[{"name":"玩玩","path":"api/categories/玩玩.json"},{"name":"资源","path":"api/categories/资源.json"}],"tags":[{"name":"Python","path":"api/tags/Python.json"},{"name":"Colaboratoty","path":"api/tags/Colaboratoty.json"},{"name":"机器学习","path":"api/tags/机器学习.json"},{"name":"VScode","path":"api/tags/VScode.json"}]}